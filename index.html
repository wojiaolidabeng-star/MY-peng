<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æåŒ»ç”Ÿå£è…”è¯Šå®¤ Â· æ•°å­—å½±åƒä¸­å¿ƒ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; }
        #bg-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        #three-container { position: absolute; top: 0; left: 0; width: 50%; height: 100%; z-index: 2; pointer-events: none; }
        /* ä¿æŒåœ¨å³ä¾§ */
        .coze-web-sdk-container { right: 20px !important; bottom: 20px !important; left: auto !important; transform: none !important; }
        .coze-web-sdk-bubble-icon { display: none !important; }
    </style>
</head>
<body>
    <script>
        // ã€ç¬¬ä¸€é“ä¿é™©ï¼šç‰©ç†æŠ¹é™¤ã€‘åœ¨ä¸€åˆ‡å¼€å§‹å‰ï¼Œå¼ºè¡Œæ¸…é™¤æµè§ˆå™¨å¯¹æœ¬åŸŸåçš„æ‰€æœ‰è®°å¿†
        localStorage.clear();
        sessionStorage.clear();
        console.log("ğŸ§¨ æµè§ˆå™¨ç¼“å­˜å·²ç‰©ç†æŠ¹é™¤ï¼Œè®°å¿†å½»åº•æ–­æ ¹");
    </script>

    <canvas id="bg-canvas"></canvas>
    <div id="three-container"></div>

    <script>
        // 1. ç”Ÿæˆç»å¯¹éšæœº ID
        const freshId = 'patient_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

        // 2. é‡æ–°æ‰“é€  3D æ ¸å¿ƒï¼šæ‰«æç¯ + ç²’å­äº‘ (ä»£æ›¿é‚£å¨ä¹±ç»³å­)
        const container = document.getElementById('three-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        const group = new THREE.Group();
        // åˆ›å»ºæ ¸å¿ƒç²’å­äº‘
        const pointsGeom = new THREE.SphereGeometry(1.2, 32, 32);
        const pointsMat = new THREE.PointsMaterial({ color: 0x00c3ff, size: 0.05, transparent: true, opacity: 0.8 });
        const corePoints = new THREE.Points(pointsGeom, pointsMat);
        group.add(corePoints);

        // åˆ›å»ºä¸¤ä¸ªäº¤å‰æ—‹è½¬çš„æ‰«æç¯
        const ringGeom = new THREE.TorusGeometry(2, 0.02, 16, 100);
        const ringMat = new THREE.MeshBasicMaterial({ color: 0x00c3ff, transparent: true, opacity: 0.5 });
        const ring1 = new THREE.Mesh(ringGeom, ringMat);
        const ring2 = new THREE.Mesh(ringGeom, ringMat);
        ring2.rotation.x = Math.PI / 2;
        group.add(ring1);
        group.add(ring2);
        
        scene.add(group);
        camera.position.z = 6;

        function animate3D() {
            requestAnimationFrame(animate3D);
            group.rotation.y += 0.01;
            ring1.rotation.y += 0.02;
            ring2.rotation.x -= 0.02;
            corePoints.rotation.z += 0.005;
            renderer.render(scene, camera);
        }
        animate3D();

        // 3. èƒŒæ™¯è“ç‚¹ç²’å­ (ä¿æŒå†·é™é£æ ¼)
        const bgCanvas = document.getElementById('bg-canvas');
        const ctx = bgCanvas.getContext('2d');
        let dots = [];
        function initDots() {
            bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight;
            for(let i=0; i<100; i++) dots.push({ x: Math.random()*bgCanvas.width, y: Math.random()*bgCanvas.height, v: Math.random()*0.3, size: Math.random()*1.5 });
        }
        function drawDots() {
            ctx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
            ctx.fillStyle = 'rgba(0, 195, 255, 0.4)';
            dots.forEach(d => { d.y -= d.v; if(d.y < 0) d.y = bgCanvas.height; ctx.beginPath(); ctx.arc(d.x, d.y, d.size, 0, Math.PI*2); ctx.fill(); });
            requestAnimationFrame(drawDots);
        }
        initDots(); drawDots();

        // 4. åŠ è½½æåŒ»ç”Ÿ
        const client = new CozeWebSDK.WebChatClient({
            config: { bot_id: '7608863077597626394' },
            componentProps: { title: 'æåŒ»ç”Ÿå£è…”è¯Šå®¤', layout: 'pc' },
            auth: {
                type: 'token',
                token: 'pat_dT8ZNCudSDhO2DRLnZMtuuZNhBwOFt4gTbNjr25yPK6FtkC5hK9VmehDLKuSqR7w',
                onRefreshToken: () => 'pat_dT8ZNCudSDhO2DRLnZMtuuZNhBwOFt4gTbNjr25yPK6FtkC5hK9VmehDLKuSqR7w'
            },
            userInfo: { id: freshId, name: 'åˆè¯Šè®¿å®¢' }, // ã€ç¬¬äºŒé“ä¿é™©ï¼šå¼ºåˆ¶æ¢å·ã€‘
            ui: { asstBtn: { isNeed: false } }
        });
        client.showChatBot();
    </script>
</body>
</html>

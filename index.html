<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>李医生数字口腔中心</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; }
        #three-container { position: absolute; top: 0; left: 0; width: 60%; height: 100%; z-index: 2; pointer-events: none; }
        .coze-web-sdk-container { right: 20px !important; bottom: 20px !important; z-index: 1000 !important; }
        .coze-web-sdk-bubble-icon { display: none !important; }
    </style>
</head>
<body>
    <div id="three-container"></div>
    <script>
        // 1. 生成绝对随机 ID，并在前端彻底清空一次缓存
        localStorage.clear(); sessionStorage.clear();
        const freshId = 'p_' + Date.now() + Math.random().toString(36).substr(2, 5);

        // 2. 重新手搓：科幻数字牙齿（立体拼搭版）
        const container = document.getElementById('three-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        const toothGroup = new THREE.Group();
        const toothMat = new THREE.MeshBasicMaterial({ color: 0x00c3ff, wireframe: true, transparent: true, opacity: 0.5 });
        
        // 牙冠：八角圆柱模拟
        const crown = new THREE.Mesh(new THREE.CylinderGeometry(1.6, 1.4, 1.8, 8), toothMat);
        // 牙根：两个斜向圆柱
        const r1 = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.1, 1.6, 8), toothMat);
        r1.position.set(0.5, -1.5, 0); r1.rotation.z = -0.3;
        const r2 = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.1, 1.6, 8), toothMat);
        r2.position.set(-0.5, -1.5, 0); r2.rotation.z = 0.3;

        toothGroup.add(crown, r1, r2);
        
        // 外围科幻扫描环
        const ring = new THREE.Mesh(new THREE.TorusGeometry(2.8, 0.03, 16, 100), new THREE.MeshBasicMaterial({ color: 0x00c3ff, transparent:true, opacity:0.8 }));
        ring.rotation.x = Math.PI / 2;
        toothGroup.add(ring);

        scene.add(toothGroup);
        camera.position.z = 8;

        function animate() {
            requestAnimationFrame(animate);
            toothGroup.rotation.y += 0.01; // 优雅旋转
            ring.position.y = Math.sin(Date.now() * 0.002) * 2; // 扫描环上下浮动
            renderer.render(scene, camera);
        }
        animate();

        // 3. 启动李医生
        const client = new CozeWebSDK.WebChatClient({
            config: { bot_id: '7608863077597626394' },
            componentProps: { title: '李医生口腔诊室', layout: 'pc' },
            auth: {
                type: 'token',
                token: 'pat_dT8ZNCudSDhO2DRLnZMtuuZNhBwOFt4gTbNjr25yPK6FtkC5hK9VmehDLKuSqR7w'
            },
            userInfo: { id: freshId, name: '访客' }
        });
        client.showChatBot();
    </script>
</body>
</html>
